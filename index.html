<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox Texture Decoder</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        input { margin: 10px; padding: 10px; }
        button { padding: 10px 20px; }
        pre { background: #f4f4f4; padding: 10px; border: 1px solid #ddd; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Roblox Texture Decoder</h1>
    <p>Enter a Roblox asset ID to decode its texture into RGBA data.</p>
    <input type="text" id="assetId" placeholder="Enter Asset ID">
    <button onclick="decodeTexture()">Decode</button>
    <pre id="output"></pre>

    <script>
    async function decodeTexture() {
        const assetId = document.getElementById('assetId').value;
        const output = document.getElementById('output');

        if (!assetId) {
            alert('Please enter an asset ID.');
            return;
        }

        output.textContent = 'Processing...';

        try {
            const response = await fetch(`https://roblox-image-to-binary.onrender.com/decode?id=${assetId}`);
            const data = await response.json();

            if (data.error) {
                output.textContent = `Error: ${data.error}`;
                return;
            }

            // Decode and combine buffers
            const size = data.size;
            const pixelArray = [];

            for (const buffer of data.buffers) {
                const decodedBuffer = atob(buffer); // Decode Base64
                for (let i = 0; i < decodedBuffer.length; i += 4) {
                    const r = decodedBuffer.charCodeAt(i);
                    const g = decodedBuffer.charCodeAt(i + 1);
                    const b = decodedBuffer.charCodeAt(i + 2);
                    const a = decodedBuffer.charCodeAt(i + 3);
                    pixelArray.push(r, g, b, a);
                }
            }

            // Final dictionary
            const result = {
                size: size,
                pixels: pixelArray
            };

            output.textContent = JSON.stringify(result, null, 2);
        } catch (error) {
            output.textContent = `Error: ${error.message}`;
        }
    }
</script>

</body>
</html>
